<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>μ½”μΈμ›μ‹ - μ„Ένƒμ† κ΄€λ¦¬</title>
  <link th:href="@{/css/style.css}" rel="stylesheet">
  <link th:href="@{/css/address-search.css}" rel="stylesheet">
  <link th:href="@{/css/owner-laundries.css}" rel="stylesheet">
</head>
<body>
<div th:replace="~{fragments/header :: header}"></div>

<div class="container">
  <div class="page-header">
    <h1>π μ„Ένƒμ† κ΄€λ¦¬</h1>
    <p>λ‚΄ μ„Ένƒμ†λ¥Ό λ“±λ΅ν•κ³  κ΄€λ¦¬ν•μ„Έμ”</p>
  </div>

  <!-- κ΄€λ¦¬ λ„κµ¬ -->
  <div class="management-tools">
    <button id="addLaundryBtn" class="btn btn-primary">
      β• μ„Ένƒμ† λ“±λ΅
    </button>
    <button id="refreshBtn" class="btn btn-outline">
      π”„ μƒλ΅κ³ μΉ¨
    </button>
  </div>

  <!-- μ„Ένƒμ† λ©λ΅ -->
  <div class="laundries-section">
    <div class="section-header">
      <h2>π“ λ‚΄ μ„Ένƒμ† λ©λ΅</h2>
      <div class="laundry-stats">
        <span>μ΄ <span id="totalCount">0</span>κ°</span>
      </div>
    </div>

    <div id="laundriesList" class="owner-laundries-list">
      <!-- JavaScriptλ΅ λ™μ  λ΅λ”© -->
    </div>

    <!-- νμ΄μ§€λ„¤μ΄μ… -->
    <div id="pagination" class="pagination">
      <!-- JavaScriptλ΅ λ™μ  μƒμ„± -->
    </div>
  </div>

  <!-- λ΅λ”© μ¤ν”Όλ„ -->
  <div id="loading" class="loading-spinner" style="display: none;">
    <div class="spinner"></div>
    <p>μ„Ένƒμ† μ •λ³΄λ¥Ό λ¶λ¬μ¤λ” μ¤‘...</p>
  </div>
</div>

<!-- μ„Ένƒμ† λ“±λ΅/μμ • λ¨λ‹¬ -->
<div id="laundryModal" class="modal" style="display: none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="modalTitle">β• μ„Ένƒμ† λ“±λ΅</h3>
      <span class="close" id="closeLaundryModal">&times;</span>
    </div>
    <div class="modal-body">
      <form id="laundryForm">
        <input type="hidden" id="laundryId" name="laundryId">

        <!-- β… μ£Όμ† κ²€μƒ‰ μ„Ήμ… (λ“±λ΅μ‹μ—λ§ ν‘μ‹) -->
        <div id="addressSearchSection">
          <div class="form-group">
            <label for="addressSearch">π“ μ£Όμ† κ²€μƒ‰</label>
            <div class="address-search-group">
              <input type="text" id="addressSearch" placeholder="μ£Όμ†λ¥Ό κ²€μƒ‰ν•μ„Έμ”" class="form-control">
              <button type="button" id="searchAddressBtn" class="btn btn-outline">π” κ²€μƒ‰</button>
            </div>
          </div>

          <div id="addressResults" class="address-results" style="display: none;">
            <h4>κ²€μƒ‰ κ²°κ³Ό</h4>
            <div id="addressList" class="address-list">
              <!-- JavaScriptλ΅ λ™μ  μƒμ„± -->
            </div>
          </div>
        </div>

        <!-- β… μ„ νƒλ μ£Όμ† μ„Ήμ… (λ“±λ΅μ‹μ—λ§ ν‘μ‹) -->
        <div id="selectedAddressSection">
          <!-- μ„ νƒλ μ£Όμ† ν‘μ‹ (customerμ™€ λ™μΌν• κµ¬μ΅°) -->
          <div id="selectedAddress" class="selected-address" style="display: none;">
            <div class="selected-header">
              <span>β… μ„ νƒλ μ£Όμ†</span>
              <button type="button" id="clearSelected" class="clear-results-btn" onclick="clearSelectedAddress()">β•</button>
            </div>
            <div class="selected-content">
              <div class="address-name" id="selectedAddressName"></div>
              <div class="address-coords" id="selectedAddressCoords"></div>
            </div>
          </div>

          <!-- νΌ μ „μ†΅μ© μ¨κ²¨μ§„ ν•„λ“λ“¤ -->
          <input type="hidden" id="addressName" name="addressName">
          <input type="hidden" id="latitude" name="latitude">
          <input type="hidden" id="longitude" name="longitude">
        </div>

        <div class="form-group">
          <label for="description">π·οΈ μ„Ένƒμ† μ„¤λ…</label>
          <textarea id="description" name="description"
                    placeholder="μ„Ένƒμ†μ— λ€ν• κ°„λ‹¨ν• μ„¤λ…μ„ μ…λ ¥ν•μ„Έμ”"
                    class="form-control" rows="3"></textarea>
        </div>

        <div class="modal-actions">
          <button type="submit" class="btn btn-primary">
            β¨ μ €μ¥
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- μƒνƒ λ³€κ²½ λ¨λ‹¬ -->
<div id="statusModal" class="modal" style="display: none;">
  <div class="modal-content">
    <div class="modal-header">
      <h3>π”§ μ΄μ μƒνƒ λ³€κ²½</h3>
      <span class="close" id="closeStatusModal">&times;</span>
    </div>
    <div class="modal-body">
      <p id="statusChangeMessage"></p>
      <div class="status-options">
        <div class="status-option">
          <div class="status-icon">β…</div>
          <div class="status-info">
            <h4>μ •μƒ μμ—…</h4>
            <p>κ³ κ°μ΄ μ„Ένƒμ†λ¥Ό μ΄μ©ν•  μ μμµλ‹λ‹¤</p>
          </div>
        </div>
        <div class="status-option">
          <div class="status-icon">β</div>
          <div class="status-info">
            <h4>μμ—… μ¤‘λ‹¨</h4>
            <p>μ„μ‹μ μΌλ΅ μμ—…μ„ μ¤‘λ‹¨ν•©λ‹λ‹¤</p>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="confirmStatusChange" class="btn btn-primary">
          β… λ³€κ²½
        </button>
        <button id="cancelStatusChange" class="btn btn-secondary">
          β μ·¨μ†
        </button>
      </div>
    </div>
  </div>
</div>

<div th:replace="~{fragments/footer :: footer}"></div>
<script th:src="@{/js/address-search-utils.js}"></script>
<script th:src="@{/js/owner-laundries.js}"></script>
</body>
</html>
