spring:
  application:
    name: coinwash

  # Thymeleaf ê¸°ë³¸ ì„¤ì •
  thymeleaf:
    cache: false  # ê°œë°œìš© - í…œí”Œë¦¿ ë³€ê²½ì‹œ ì¦‰ì‹œ ë°˜ì˜
    encoding: UTF-8
    mode: HTML
    prefix: classpath:/templates/
    suffix: .html

  # ì •ì  ë¦¬ì†ŒìŠ¤ ì„¤ì •
  web:
    resources:
      static-locations: classpath:/static/

  datasource:
    # ğŸ”§ Docker ì„œë¹„ìŠ¤ëª… ì‚¬ìš© + í™˜ê²½ë³€ìˆ˜ë¡œ ë™ì  ì„¤ì •
    url: ${SPRING_DATASOURCE_URL:jdbc:mysql://mysql:3306/coinwash?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Seoul}
    driver-class-name: com.mysql.cj.jdbc.Driver
    username: ${SPRING_DATASOURCE_USERNAME:user}
    password: ${MYSQL_PASSWORD}
    hikari:
      # ğŸ¯ ì„±ëŠ¥ ìµœì í™” (production-ready)
      maximum-pool-size: 300        # 15 â†’ 300 (ê³ ì„±ëŠ¥)
      minimum-idle: 100             # 5 â†’ 100 (ì•ˆì •ì„±)
      connection-timeout: 20000     # ìœ ì§€ (20ì´ˆ)

      # ğŸ” ëª¨ë‹ˆí„°ë§ í™œì„±í™”
      register-mbeans: true
      leak-detection-threshold: 60000  # ìœ ì§€ (60ì´ˆ)

      # ğŸ”§ ì„±ëŠ¥ ìµœì í™” ì˜µì…˜ë“¤
      idle-timeout: 300000          # 5ë¶„ ìœ ì§€
      max-lifetime: 1800000         # 15ë¶„ â†’ 30ë¶„ (ì•ˆì •ì„±)
      validation-timeout: 3000      # 5ì´ˆ â†’ 3ì´ˆ (ë¹ ë¥¸ ê²€ì¦)
      initialization-fail-timeout: 1  # ë¹ ë¥¸ ì‹¤íŒ¨


  jpa:
    show-sql: true  # ê°œë°œìš© ìœ ì§€
    hibernate:
      ddl-auto: update  # ê°œë°œìš© ìœ ì§€
    properties:
      hibernate:
        # ğŸš€ JPA ì„±ëŠ¥ ìµœì í™” (ì•ˆì „í•œ ì„¤ì •)
        jdbc.batch_size: 50           # ë°°ì¹˜ ì²˜ë¦¬
        order_inserts: true           # ì‚½ì… ìˆœì„œ ìµœì í™”
        order_updates: true           # ì—…ë°ì´íŠ¸ ìˆœì„œ ìµœì í™”
        jdbc.batch_versioned_data: true

  jwt:
    secret: ${JWT_SECRET_KEY}

  data:
    redis:
      # ğŸ”§ Docker ì„œë¹„ìŠ¤ëª… ì‚¬ìš©
      host: ${REDIS_HOST:redis}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD}
      timeout: 2000ms               # 20ì´ˆ â†’ 2ì´ˆ (ì ì ˆí•œ íƒ€ì„ì•„ì›ƒ)
      connect-timeout: 3000ms       # 5ì´ˆ â†’ 3ì´ˆ (ë¹ ë¥¸ ì—°ê²°)
      lettuce:
        pool:
          # ğŸ¯ Redis ì»¤ë„¥ì…˜ í’€ ìµœì í™”
          max-active: 500             # 100 â†’ 500 (ê³ ì„±ëŠ¥)
          max-idle: 100               # 50 â†’ 100 (ì ì ˆí•œ ìœ ì§€)
          min-idle: 20                # 5 â†’ 20 (ê¸°ë³¸ í™•ë³´)
          max-wait: 3000ms            # ìœ ì§€ (3ì´ˆ)

          # ğŸ”§ ì»¤ë„¥ì…˜ ê´€ë¦¬ ìµœì í™”
          test-on-borrow: false       # ë¹Œë¦´ ë•Œ í…ŒìŠ¤íŠ¸ ìƒëµ
          test-on-return: false       # ë°˜ë‚© ì‹œ í…ŒìŠ¤íŠ¸ ìƒëµ
          test-while-idle: true       # ìœ íœ´ ì‹œì—ë§Œ í…ŒìŠ¤íŠ¸
          time-between-eviction-runs: 30000ms  # 30ì´ˆë§ˆë‹¤ ì •ë¦¬
          min-evictable-idle-time: 60000ms     # 60ì´ˆ ìœ íœ´ ì‹œ ì œê±°

        shutdown-timeout: 2000ms      # 100ms â†’ 2ì´ˆ (ì•ˆì •ì  ì¢…ë£Œ)


kakao:
  api:
    key: ${KAKAO_API_KEY}

# ğŸš€ ì„œë²„ ì„±ëŠ¥ ìµœì í™” (ì¶”ê°€)
server:
  tomcat:
    threads:
      max: 500
      min-spare: 50
    max-connections: 10000
    connection-timeout: 30000
    accept-count: 200
    max-http-form-post-size: 2MB

    # ğŸ”§ ì¶”ê°€ ìµœì í™”
    processor-cache: 200
    max-keep-alive-requests: 100

# ğŸ” ë¡œê¹… ìµœì í™”
logging:
  level:
    com.zaxxer.hikari: INFO
    org.springframework.web: INFO
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE


